Land cover in the Chicamocha River canyon based on satellite data and Random Forest Classification
Helbert García-Delgado
1. Introduction
The tropical Northern Andes is one, if not the most, biodiverse region of the world (Rahbek et al., 2019). An exceptional record of plants (>45,000 species) and vertebrates are found in the Andes biodiverse hotspot (Myers et al., 2000). The Chicamocha Canyon, in the Eastern Cordillera of Colombia (Fig. 1), is home to some endemic species typical of the biological richness of the Andes. Despite several studies showing an intrinsic relationship between the Canyon and biodiversity, no study has explored how the formation of the Canyon led to the current diversity. Within this diversity, we find a remnant of the seasonally dry tropical forest (SDTF), with native species of plants and birds such as the succulent-trunked tree locally known as “Ceiba Barrigona” (Bacon et al., 2021).
As part of my project, I plan to map the extent of the species-rich SDTF in the Chicamocha River canyon (Fig. 1). This initial step will allow us to know if the SDTF is restricted to certain environmental conditions that were induced by the formation of the Chicamocha River canyon.
Fig. 1 Location of the Area of Interest (AOI) in the Colombian Northern Andes. The satellite image is a high-resolution PlanetLabs basemap displaying the different land covers visible in the Chicamocha River canyon. Some areas lack dense vegetation cover and are interpreted as remnants of the SDTF. This ecosystem is usually accompanied by exposed bedrock and landslides. 

2. Data and methods
For this project, I used high-resolution multispectral imagery provided by Planet Labs© and medium-resolution Sentinel 2A imagery to understand environmental conditions in the Chicamocha River canyon of the Colombian Andes (Fig. 1). In recent years, Planet was involved with Norway’s International Climate and Forests Initiative (NICFI) program that allows access to 4m-resolution monthly basemaps in tropical regions. The satellite data is released as 4-band analysis-ready mosaics of the tropics and can be accessed at https://www.planet.com/basemaps/#/mosaic/. Below, I show one example of a tile collected in May 2022 (Figure 1). Each tile is composed of four bands (B1, B2, B3, and B4). These three bands cover the Blue (455 – 515 nm), Green (500 – 590 nm), Red (590 – 670 nm), and Near-Infrared (780 – 860 nm) wavelengths of the light spectrum. The NICFI project has covered the tropics with high-resolution satellite imagery for the last 7 years with monthly basemaps. I therefore collected almost free-cloud imagery from this period that matches with an Area of Interest (AOI). The AOI spans an area of approximately 1,400 km2 and presents different environmental conditions that I am willing to study.
Besides, I used Sentinel 2A imagery that was downloaded and processed with the aim of the Google Earth Engine. The Sentinel 2A images were used to derive the Normalized Difference Vegetation Index (NDVI). The NDVI will be the predictor used in this project to map the extent of different land covers in the Chicamocha River canyon, including the SDTF.
2.1 2.	Data processing description
In this project, a model that classifies land cover (and by extension, ecosystems) was developed. The predictor variable was a mean NDVI raster obtained after processing Sentinel 2A imagery spanning from 2015 to the present. The study area has the advantage that it is cloudless most time of the year and thus a cloud mask is not necessary to be applied. The training data for the regression model was a vector dataset containing entities classified as: mesic forest, crops, dry forest (SDTF), bedrock, landslides, water bodies, and human infrastructure/urban areas. The training dataset is made up of the visual interpretation of high-resolution PlanetLabs imagery with a resolution of 4-m per pixel and 1:100,000 land cover maps provided by the Colombian Government. The selection of the training and test dataset was random. Approximately 80% of the pixels derived from the original vector dataset will be used as training samples while the remaining 20% will be used to test the accuracy and fitting of the model. The methodology followed in this project is similar to the one used by Malinowski et al. (2020). 
A sample of Sentinel 2A images was selected and the NDVI was computed with the aim of the Google Earth Engine. The script of this process is available at https://github.com/hsgarciad/EnvDatSci22/blob/ed32a41fbe845d0a54eeb803aec3de7c9f24a226/Class%20Project/Data%20download%20and%20pre-process%20code. Once I get the NDVI (Fig. 2), each image will be independently analyzed, and the random forest methodology will be applied. Belgiu and Drâguţ (2016) provided a background on the applications of the random forest (RF) classifier in remote sensing. According to these authors, the RF classifier helps to identify the most relevant multisource data in spectral images while avoiding overfitting, and inaccurate training of predicting data. Once the model was fitted, I will evaluate the prediction score of the RF model. In other words, I will evaluate if the model can identify the different land cover classes with a certain degree of confidence.
 
Fig. 2 NDVI raster of the AOI. The two main contrasting ecosystems, SDTF and Mesic Forest are shown. Note how the SDTF is dominantly located at the bottom of the valley. 
3. Results and discussion
For the classification of the land cover in the Chicamocha River canyon, I used a total of 81,978 pixels classified into seven different classes defined in Table 1. The class with the most pixels is the Mesic Forest with 22,918 pixels, followed by the SDTF with 20,949 pixels.

Table 1. Number of pixels per class
Classes	# Pixels
Class 1 – Mesic Forest	22918
Class 2 - Crops	2608
Class 3 – Dry Forest	20949
Class 4 - Bedrock	5306
Class 5 - Landslides	2904
Class 6 – Water bodies	9090
Class 7 – Infrastructure	1807

A first inspection of the NDVI raster dataset permits the identification of stark differences in this index between the vegetation cover at the bottom and hillslopes surrounding the Chicamocha River canyon (Fig. 2). Such a difference is marked when the Chicamocha River flows in an N-S direction, parallel to the structural grain of the cordillera and perpendicular to the moisture flow.
 
Fig. 3 NDVI raster (left) and training data (right) after being converted into arrays and imported into Python.

After training the RF algorithm, I first revised the Out of Bag (OOB) and accuracy scores in order to validate the model. I got an OOB of 60.28% but an accuracy score of 99%. One way to explain these differences is that the number of pixels in the training dataset is unbalanced. As seen in Table 1, some classes have up to an order of magnitude more pixels compared to the landslides class. This could cause the model to not have enough pixels to differentiate between classes and therefore assign some pixels to other, more dominant classes. This could be a future approach to improve the OOB score and the misidentification of pixels after training the RF model.
Below I show the prediction of the land cover in the AOI based on the RF model (Fig. 4). In general, it is visible how the model merges several areas classified as water bodies with areas where bedrock or landslides are exposed. This is especially true in the middle right part of the AOI where the Chicamocha River flows northwardly. Besides balancing the pixels, a complementary approach could be integrating a water mask within the input raster dataset. This would be necessary since the streams in this region carry enough suspended sediment to alter the reflectance of the water surface. Therefore, the spectral signal of the main streams can be confused with landslides or exposed bedrock because the reflectance would be similar. The opposite case would be expected in areas where the sediment load is lower and therefore the spectral signal is different from exposed areas with little or no vegetation.
Despite the errors found, the model can accurately predict the differences between the SDTF and the Mesic Forest, the main objective of this project. Note in Fig. 4 how there is a well-marked sectorization between the land covers towards the bottom of the canyon, compared to the higher zones on the hillslopes. Interestingly, the SDTF extends in some areas beyond the valley floor (Fig. 4). This occurs in places where there is a change in the flow direction of the Chicamocha River. These zones have an east-west direction, being parallel to the direction in which the moisture is transported in the cordillera. My interpretation is that the incision of the Chicamocha River canyon during the Pleistocene (Struth et al., 2020) modified the local microclimate, forcing an elevational gradient in the environmental conditions. Similar observations have been made in the Peruvian Andes by authors trying to explain the juxtaposition of Mesic Forests and Dry Forests like the SDTF over relatively short distances. For instance, Killeen et al. (2007) noticed that inter-Andean valleys can display day-to-day weather oscillations that in turn induce elevational gradients in environmental conditions. During the day, shortwave radiation heats the valley bottom, forcing the moisture to escape towards the flanks of the valley. As a result, the valley bottom dries while precipitation is enhanced at higher elevations. The elevational dependence of climate and by extension of vegetation is not so far removed from the observations made by naturalist Alexander von Humboldt and majestically illustrated in his famous painting of the Chimborazo volcano and its elevation-dependent vegetation gradient (von Humbold, 1807).
Fig. 4 Classified raster of the AOI with the seven classes of land cover defined in this project.
4. Conclusions
In summary, a supervised classification using a training dataset of 81,978 pixels, along with an NDVI raster of the Chicamocha River canyon, was used to map the land cover. Although the OOB score of the RF model is not the most optimal due to an imbalance in the number of pixels, some results were promising. It was possible to adequately differentiate the SDTF from the humid Mesic Forest ecosystems. This was the main objective of the present project. The elevation-dependent vegetation gradient is hypothesized to be related to the formation of the canyon landform during the Pleistocene.
As future work, it is expected to include other satellite data that can improve the identification of water bodies of other classes, in addition to balancing the number of pixels.
5. References cited
Bacon, C.D., Gutiérrez‐Pinto, N., Flantua, S., Castellanos Suárez, D., Jaramillo, C., Pennington, R.T., and Antonelli, A., 2021, The seasonally dry tropical forest species Cavanillesia chicamochae has a middle Quaternary origin: Biotropica, p. 1–9, doi:10.1111/btp.13031.
Belgiu, M., Drâguţ, L., 2016, Random forest in remote sensing: A review of applications and future directions. ISPRS J. Photogramm. Remote Sens., v. 114, p. 24–31, doi: 10.1016/j.isprsjprs.2016.01.011.
Hazzi, N.A., Moreno, J.S., Ortiz-Movliav, C., and Palacio, R.D., 2018, Biogeographic regions and events of isolation and diversification of the endemic biota of the tropical Andes: Proceedings of the National Academy of Sciences of the United States of America, v. 115, p. 7985–7990, doi:10.1073/pnas.1803908115.
Killeen, T.J., Douglas, M., Consiglio, T., Jørgensen, P.M., and Mejia, J., 2007, Dry spots and wet spots in the Andean hotspot: Journal of Biogeography, v. 34, p. 1357–1373, doi:10.1111/j.1365-2699.2006.01682.x.
Malinowski, R., Lewinski, S., Rybicki, M., Gromny, E., et al., 2020, Automated Production of a Land Cover/Use Map of Europe Based on Sentinel-2 Imagery. Remote Sensing, v. 12, 3523, doi: 10.3390/rs12213523.
Myers, N., Mittermeier, R.A., Mittermeier, C.G., da Fonseca, G.A.B., and Kent, J., 2000, Biodiversity hotspots for conservation priorities: Nature, v. 403, p. 853–858, doi:10.1038/35002501.
Pennington, R.T., Lavin, M., Särkinen, T., Lewis, G.P., Klitgaard, B.B., and Hughes, C.E., 2010, Contrasting plant diversification histories within the Andean biodiversity hotspot: Proceedings of the National Academy of Sciences of the United States of America, v. 107, p. 13783–13787, doi:10.1073/pnas.1001317107.
Rahbek, C., Borregaard, M.K., Colwell, R.K., Dalsgaard, B., Holt, B.G., Morueta-Holme, N., Nogues-Bravo, D., Whittaker, R.J., and Fjeldså, J., 2019, Humboldt’s enigma: What causes global patterns of mountain biodiversity? Science, v. 365, p. 1108–1113, doi:10.1126/science.aax0149.
Struth, L., Giachetta, E., Willett, S.D., Owen, L.A., and Tesón, E., 2020, Quaternary drainage network reorganization in the Colombian Eastern Cordillera Plateau: Earth Surface Processes and Landforms, doi:10.1002/esp.4846.
von Humboldt, A., 1807, Essay on the Geography of Plants (English Translation 2009): The University of Chicago Press, 296 p.

